<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title> Song App</title>
    <link rel="stylesheet" type="text/css" href="font-awesome.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
    <div class="wrapper">        
        <section class="welcome-screen hidden">
            <h1> Welcome to Songify </h1>
            <h3> Enter name to access your account </h3>
            <div class="input-wrapper">       
                <input type="text" placeholder="Name" id="name-input">
                <button> Go </button>
            </div>                           
        </section>
        <div class="main">             
            <header>
                <div class="right floated user-name"> </div>        
            </header>

            <div id="result" style="  'height: 20px; border: 1px solid #ccc; padding: 2px; margin-top: 5px; font-size: 14px; "></div>
    <button onclick="startConverting();" style="font-size: 20px; position: absolute; top: 25px; left: 50%;"><i class="fa fa-microphone"></i></button>
    

            <section class="content">
                <audio></audio>

              <table id="songs">
                <thead class="list-headers">
                  <tr>
                    <td> Title </td>
                    <td> Artist </td>
                    <td> Album </td>
                    <td> Duration </td>
                  </tr>
                </thead>

              <div class="song-list"> 
               <tbody>
                 <tr class="song" id="song1">
                    <td class="song-name"></td>
                    <td class="song-artist"></td>
                    <td class="song-album"></td>
                    <td class="song-length"></td>
                 </tr>
                 <tr class="song" id="song2">
                    <td class="song-name"></td>
                    <td class="song-artist"></td>
                    <td class="song-album"></td>
                    <td class="song-length"></td>
                 </tr>
                 <tr class="song" id="song3">
                   <td class="song-name"></td>
                   <td class="song-artist"></td>
                   <td class="song-album"></td>
                   <td class="song-length"></td>
                 </tr>
                 <tr class="song" id="song4">
                    <td class="song-name"></td>
                    <td class="song-artist"></td>
                    <td class="song-album"></td>
                    <td class="song-length"></td>
                 </tr>
              </div> 
              </tbody>
            </table>
        
        
        <div class="current-song-wrapper">
          <img  class="current-song-image">
          <div>
          <p class="current-song-name"></p>
          <p class="current-song-album"></p>
        </div>
         </div> 
        

            </section>
            <footer>
                <div class="controls">                   
                    <div class="player-buttons">
                        <i class="fa fa-random clickable disabled" aria-hidden="true"></i>
                        <i class="fa fa-step-backward clickable" aria-hidden="true"></i>
                        <i class="fa fa-play clickable play-icon" aria-hidden="true"></i>
                        <i class="fa fa-step-forward clickable" aria-hidden="true"></i>
                        <i class="fa fa-repeat disabled clickable" aria-hidden="true"></i>
                    </div>                              
                    <div class="progress-wrapper">         
                        <span class="time-elapsed"> </span>
                        <div class="player-progress">          
                            <div class="progress-filled"> </div>     
                        </div>
                         <span class="song-duration"></span>
                    </div>                                          
                </div>                                              
            </footer>
        </div>                                                       
    </div>                                                          
      
<script src="jquery.js"></script>

<script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>

<!-- <script src="speech.js"></script> -->
<script src="main.js"></script>

<script>
  if (window['webkitSpeechRecognition']) {
    var speechRecognizer = new webkitSpeechRecognition();
    // recognition will not end when user stops speaking if set to true
    speechRecognizer.continuous = true;
    // process the request while the user is speaking
    // and their commands are final. Set to false by default
    speechRecognizer.interimResults = true;
    speechRecognizer.lang = "en-US";
    var currentCommands = ['play', 'stop', 'pause', 'next', 'previous'],
        results = [],
        timeoutSet = false;

    speechRecognizer.onresult = function (evt) {
     // audioPlayer.toggleSpinner(true);
      results.push(evt.results);     //The push() method adds new items to the end of an array, and returns the new length.
      if (!timeoutSet) {
        setTimeout(function() {     //The setTimeout() method calls a function or evaluates an expression after a specified number of milliseconds.
          timeoutSet = false;
          results.reverse();       //The reverse() method reverses the order of the elements in an array.
          try {
            results.forEach(function (val, i) {   //The forEach() method calls a provided function once for each element in an array, in order.
              var el = val[0][0].transcript.toLowerCase();
              if (currentCommands.indexOf(el.split(" ")[0]) !== -1) {  //split() method is used to split a string into an array of substrings, and returns the new array.
                                                                    //indexOf() method tells index of
                speechRecognizer.abort();
                //audioPlayer.processCommands(el);
                //audioPlayer.toggleSpinner();
                addSongNameClickEvent(songs[0],1);
                results = [];
                throw new BreakLoopException;

              }
              if (i === 0) {
                //audioPlayer.processCommands(el);
                speechRecognizer.abort();
                //audioPlayer.toggleSpinner();
                results = [];
              }
            });
          }
          catch(e) {return e;}
        }, 3000)
      }

      timeoutSet = true;
    }
    speechRecognizer.onend = function () {
      speechRecognizer.start();
    }

    speechRecognizer.start();
  }
  else {
    alert("Your browser does not support the Web Speech API");
  }
</script>
</body>

</html>
